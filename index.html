<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Queens League Oysho - Álbum Virtual</title>
  <meta name="description" content="Álbum virtual de Queens League Oysho — sobres, cromos y bonos" />
  <link rel="icon" href="https://queensleague.pro/favicon.ico" />
  <style>
    :root{
      --bg: #2a0a49;
      --accent: #06ccbd;
      --accent-text: #2a0a49;
      --card-bg: #e5e7eb;
      --white: #ffffff;
      --danger: #e11d48;
      --shadow-accent: rgba(6,204,189,0.18);
      --max-width: 1000px;
      --radius: 12px;
      --transition: 200ms ease;
      --header-height: 68px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin: 0;
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: var(--white);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
      -webkit-tap-highlight-color: transparent;
    }

    /* HEADER */
    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:1rem;
      padding: 0.8rem 1.25rem;
      background: var(--bg);
      border-bottom: 2px solid var(--accent);
      box-shadow: 0 3px 12px var(--shadow-accent);
      position: sticky;
      top: 0;
      z-index: 50;
      height: var(--header-height);
    }

    .logo {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--accent);
      letter-spacing: 0.4px;
      cursor: pointer;
      user-select: none;
    }

    .redes {
      display:flex;
      gap:0.6rem;
      align-items:center;
      margin-left: 0.25rem;
    }

    .redes a {
      color: var(--accent);
      text-decoration:none;
      padding: 0.2rem 0.45rem;
      border-radius:8px;
      font-weight:600;
      transition: background var(--transition), color var(--transition), transform var(--transition);
      font-size:0.92rem;
    }

    .redes a:hover,
    .redes a:focus {
      background: var(--accent);
      color: var(--accent-text);
      transform: translateY(-1px);
      outline: none;
    }

    #monedas-panel {
      background: var(--accent);
      color: var(--accent-text);
      padding: .32rem .75rem;
      border-radius: 10px;
      font-weight:700;
      box-shadow: 0 6px 20px var(--shadow-accent);
      cursor: pointer;
      border: 2px solid var(--accent-text);
      transition: transform var(--transition), box-shadow var(--transition);
      white-space: nowrap;
    }

    #monedas-panel:active { transform: translateY(1px) }
    #monedas-panel:focus { outline: 3px solid rgba(6,204,189,0.18); }

    /* nav menu (always visible) */
    .main-menu {
      display:flex;
      gap:0.5rem;
      align-items:center;
    }
    .main-menu button {
      background: transparent;
      color: var(--white);
      border: 2px solid rgba(255,255,255,0.06);
      padding: .45rem .75rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight:700;
      transition: background var(--transition), color var(--transition), transform var(--transition);
      font-size:0.92rem;
    }
    .main-menu button:hover, .main-menu button:focus {
      background: var(--accent);
      color: var(--accent-text);
      transform: translateY(-2px);
      outline: none;
    }

    /* MAIN CONTENT - removed large fixed min-height to avoid blank gap */
    #main-content{
      max-width: var(--max-width);
      margin: 1rem auto;
      padding: 1rem;
      background: var(--white);
      color: var(--accent-text);
      border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(6,204,189,0.06);
      min-height: 0;
      display:block;
      align-items: flex-start;
      overflow: visible;
    }

    /* Menu principal aligned to top */
    .menu-principal {
      display:flex;
      flex-direction:column;
      gap:0.9rem;
      align-items:flex-start;
      padding: 0.25rem;
    }

    .menu-principal .actions {
      display:flex;
      gap:0.6rem;
      flex-wrap:wrap;
      justify-content:flex-start;
    }

    .login-btn {
      background: var(--accent);
      color: var(--accent-text);
      border: none;
      padding: .6rem .9rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight:700;
    }

    .filtro-categoria {
      display:inline-block;
      padding: .45rem .8rem;
      border-radius:8px;
      border:2px solid var(--accent);
      background: var(--white);
      color: var(--accent-text);
      font-weight:700;
    }

    .album-grid, .sobre-grid, .packs-grid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap:1rem;
      margin-top:1rem;
    }

    .cromo {
      background: var(--card-bg);
      border-radius: 10px;
      padding: .5rem;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      position:relative;
      box-shadow: 0 6px 16px rgba(6,204,189,0.06);
      overflow:visible;
      min-height: 140px;
    }

    .cromo img {
      width:100px;
      height:140px;
      object-fit:cover;
      border-radius:8px;
      border: 3px solid var(--accent);
      background: var(--white);
      cursor:pointer;
      transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
    }

    .pack {
      display:flex;
      align-items:center;
      justify-content:center;
      height:140px;
      border-radius:12px;
      background: linear-gradient(180deg,#350a54,#2a0a49);
      color:var(--accent);
      font-weight:800;
      cursor:pointer;
      border: 3px solid rgba(6,204,189,0.08);
      box-shadow: 0 10px 28px rgba(6,204,189,0.06);
    }
    .pack.opened { opacity: 0.6; transform: scale(.98); cursor: default; }

    .duplicadas {
      position:absolute;
      top:8px;
      right:10px;
      background: var(--accent);
      color: var(--accent-text);
      padding:6px 10px;
      border-radius:999px;
      font-weight:800;
      border:2px solid var(--accent-text);
      box-shadow: 0 6px 18px rgba(6,204,189,0.12);
    }

    .btn-vender {
      position:absolute;
      bottom:8px;
      right:8px;
      background: var(--accent);
      color: var(--accent-text);
      border: none;
      padding:6px 10px;
      border-radius:8px;
      font-weight:700;
      cursor:pointer;
      transition: background var(--transition), transform var(--transition);
    }

    .progreso-album {
      text-align:left;
      font-weight:800;
      color: var(--accent);
      margin-bottom: .6rem;
    }

    /* modals hidden by default shouldn't affect layout */
    #modal, #modal-cards {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(42,10,73,0.78);
      z-index: 1200;
      padding: 1rem;
      pointer-events: none;
    }

    #modal[style*="display: flex"], #modal-cards[style*="display: flex"] {
      display: flex !important;
      pointer-events: auto;
    }

    #modal img, #modal-cards img {
      max-width: 92vw;
      max-height: 80vh;
      border-radius: 14px;
      border: 6px solid var(--white);
      box-shadow: 0 18px 48px rgba(6,204,189,0.18);
      background: var(--white);
      display:block;
    }

    #modal-close, #modal-cards-close {
      position: absolute;
      top: 20px;
      right: 28px;
      font-size: 2.2rem;
      color: var(--accent);
      background:none;
      border: none;
      cursor: pointer;
    }

    #modal-info, #modal-cards-info {
      margin-top: .9rem;
      background: var(--white);
      color: var(--accent-text);
      padding: .8rem 1.2rem;
      border-radius: 10px;
    }

    #notificacion {
      position: fixed;
      top: 28px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--accent);
      color: var(--accent-text);
      padding: 10px 20px;
      border-radius: 12px;
      font-weight:800;
      box-shadow: 0 10px 30px rgba(6,204,189,0.12);
      z-index: 2000;
      display:none;
    }

    footer {
      margin-top: 1rem;
    }

    .footer-content {
      display:flex;
      justify-content:center;
      gap: 0.6rem;
      align-items:center;
      padding: 0.9rem 1rem;
      color: var(--accent);
      background: var(--bg);
      border-top: 1px solid rgba(6,204,189,0.06);
      border-radius: 6px;
    }

    :focus { outline-offset: 3px; }
    button:focus, a:focus, input:focus { box-shadow: 0 0 0 4px rgba(6,204,189,0.12); }

    @media (max-width: 900px) {
      header { padding: 0.6rem 0.8rem; height: auto; }
      .logo { font-size:1.1rem; }
      #main-content { margin: 0.8rem; padding: 0.9rem; }
      .album-grid, .sobre-grid, .packs-grid { grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap:0.7rem; }
      .cromo { min-height: 120px; }
      .cromo img { width: 86px; height:120px; }
    }

    @media (max-width: 420px) {
      .redes { display:none; }
      .main-menu { display:flex; gap:4px; flex-wrap:wrap; }
    }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; gap:0.9rem;">
      <div class="logo" id="logo">Álbum Queens League Oysho</div>
      <nav class="redes" aria-label="Redes">
        <a href="https://queensleague.pro" target="_blank" rel="noopener">Web</a>
        <a href="https://x.com/QueensLeague" target="_blank" rel="noopener">X</a>
        <a href="https://instagram.com/QueensLeague" target="_blank" rel="noopener">Instagram</a>
        <a href="https://tiktok.com/@QueensLeague" target="_blank" rel="noopener">TikTok</a>
      </nav>
    </div>

    <div style="display:flex; align-items:center; gap:0.8rem;">
      <div id="monedas-panel" role="status" aria-live="polite">Monedas: 0</div>
      <div class="main-menu" id="main-menu">
        <button id="btn-sobres">Abrir Sobre</button>
        <button id="btn-album">Ver Mi Álbum</button>
        <button id="btn-daily">Bonus Diario</button>
        <button id="btn-twitter">Bonus X</button>
        <button id="btn-twitch">Bonus Twitch</button>
      </div>
    </div>
  </header>

  <main id="main-content" role="main" tabindex="-1">
    <!-- Contenido dinámico -->
  </main>

  <!-- Modal imagen -->
  <div id="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <button id="modal-close" aria-label="Cerrar modal">&times;</button>
    <img id="modal-img" src="" alt="Cromo ampliado" />
    <div id="modal-info" aria-live="polite"></div>
  </div>

  <!-- Modal de cartas de pack -->
  <div id="modal-cards" aria-hidden="true" role="dialog" aria-modal="true">
    <button id="modal-cards-close" aria-label="Cerrar modal">&times;</button>
    <div id="modal-cards-container" style="max-width:95vw; width:920px; background:var(--white); padding:1rem; border-radius:12px; text-align:center;">
      <h3 style="margin-top:0; color:var(--accent);">Cartas del sobre</h3>
      <div id="modal-cards-grid" class="album-grid" style="margin-top:1rem;"></div>
      <div id="modal-cards-info" style="margin-top:1rem; color:var(--accent-text);"></div>
    </div>
  </div>

  <div id="notificacion" style="display:none" role="status" aria-live="assertive"></div>

  <footer>
    <div class="footer-content">
      <span>Queens League Oysho &copy; 2025 · Álbum virtual</span>
      <span>|</span>
      <a href="https://github.com/izandhh15" target="_blank" rel="noopener">Github izandhh15</a>
    </div>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // --- Lista de cartas ---
      // id: debe ser único
      // nombre: texto que se mostrará
      // tipo: "escudo", "presidenta", "supercampeonas", etc.
      // imagen: URL de la imagen de la carta
      const CARDS = [
        { id:1,nombre:"Escudo 1K",tipo:"escudo",imagen:"https://i.ibb.co/CpJ3c7B8/01-Escudo1-K.png"},
        { id:2,nombre:"Escudo Aniquiladoras FC",tipo:"escudo",imagen:"https://i.ibb.co/N2hVWpqv/02-Escudo-Aniquiladoras.png"},
        { id:3,nombre:"Escudo El Barrio",tipo:"escudo",imagen:"https://i.ibb.co/7JcZNXSQ/03-Escudo-Barrio.png"},
        { id:4,nombre:"Escudo Jijantas FC",tipo:"escudo",imagen:"https://i.ibb.co/d4w5ppfS/04-Escudo-Jijantas.png"},
        { id:5,nombre:"Escudo Kunitas",tipo:"escudo",imagen:"https://i.ibb.co/RMxrmnY/05-Escudo-Kunitas.png"},
        { id:6,nombre:"Escudo Las Troncas FC",tipo:"escudo",imagen:"https://i.ibb.co/TDwwW6Qj/06-Escudo-Las-Troncas.png"},
        { id:7,nombre:"Escudo PIO FC",tipo:"escudo",imagen:"https://i.ibb.co/Fk5XtqqS/07-Escudo-PIO.png"},
        { id:8,nombre:"Escudo Porcinas FC",tipo:"escudo",imagen:"https://i.ibb.co/W4D56C3R/08-Escudo-Porcinas.png"},
        { id:9,nombre:"Escudo Rayo de Barcelona",tipo:"escudo",imagen:"https://i.ibb.co/wr7Q4sVP/09-Escudo-Rayo-De-Barcelona.png"},
        { id:10,nombre:"Escudo Saiyans FC",tipo:"escudo",imagen:"https://i.ibb.co/9kxn2vn9/10-Escudo-Saiyans-FC.png"},
        { id:11,nombre:"Escudo Ultimate Móstoles",tipo:"escudo",imagen:"https://i.ibb.co/zVGgWPTf/11-Escudo-Ultimate-M-stoles.png"},
        { id:12,nombre:"Escudo Xbuyer Team",tipo:"escudo",imagen:"https://i.ibb.co/nM27z99j/12-Escudo-XBuyer-Team.png"},
        { id:37,nombre:"Escudo Atlético Parceras",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:38,nombre:"Escudo Club de Cuervos",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:39,nombre:"Escudo Galácticas del Caribe",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:40,nombre:"Escudo Las Aliens FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:41,nombre:"Escudo Las Chamas FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:42,nombre:"Escudo Las Santas FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:43,nombre:"Escudo Muchachas FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:44,nombre:"Escudo Olimpo United",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:45,nombre:"Escudo Peluche Caligari",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:46,nombre:"Escudo Persas FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:47,nombre:"Escudo Raniza FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:48,nombre:"Escudo Real Titán FC",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:49,nombre:"Escudo Atlético Parceras",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:13,nombre:"Mayichi (1K)",tipo:"presidenta",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:14,nombre:"Ama Blitz (Aniquiladoras FC)",tipo:"presidenta",imagen:"https://i.ibb.co/0p9Js9tm/13-Mayichi.png"},
        { id:15,nombre:"Adri Contreras + Mercedes Roa (El Barrio)",tipo:"presidenta",imagen:"https://i.ibb.co/V01ZjqVb/15-Mercedes-Roa-Adri-Contreras.png"},
        { id:16,nombre:"Gerard Romero + Lis Cid (Jijantas FC)",tipo:"presidenta",imagen:"https://i.ibb.co/tTncqzTb/16-Gerard-Romero-Lis-Cid.png"},
        { id:17,nombre:"Jo Valicenti (Kunitas)",tipo:"presidenta",imagen:"https://i.ibb.co/whpJcVz0/17-Jo-Valicenti.png"},
        { id:18,nombre:"Violeta (Las Troncas FC)",tipo:"presidenta",imagen:"https://i.ibb.co/Kpp37QqZ/18-Violeta.png"},
        { id:19,nombre:"Rivers (PIO FC)",tipo:"presidenta",imagen:"https://i.ibb.co/hRbZNNry/19-Rivers.png"},
        { id:20,nombre:"Gemita (Porcinas FC)",tipo:"presidenta",imagen:"https://i.ibb.co/kgQqHB40/20-Gemita.png"},
        { id:21,nombre:"Spursito (Rayo de Barcelona)",tipo:"presidenta",imagen:"https://i.ibb.co/CpYRPJ7v/21-Spursito.png"},
        { id:22,nombre:"Totakeki (Saiyans FC)",tipo:"presidenta",imagen:"https://i.ibb.co/fYQ41S7r/22-Totakeki.png"},
        { id:23,nombre:"Noe9977 (Ultimate Móstoles)",tipo:"presidenta",imagen:"https://i.ibb.co/G4qQYCTY/23-Noe9977.png"},
        { id:24,nombre:"Javi Buyer + Eric Minibuyer (Xbuyer Team)",tipo:"presidenta",imagen:"https://i.ibb.co/KjRXYVtY/24-Hnos-Buyer.png"},
        { id:50,nombre:"Escudo Atlético Parceras",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:51,nombre:"Escudo Club de Cuervos",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:52,nombre:"Escudo Galácticas del Caribe",tipo:"escudoqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:53,nombre:"Escudo Las Aliens FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:54,nombre:"Escudo Las Chamas FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:55,nombre:"Escudo Las Santas FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:56,nombre:"Escudo Muchachas FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:57,nombre:"Escudo Olimpo United",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:58,nombre:"Escudo Peluche Caligari",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:59,nombre:"Escudo Persas FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:60,nombre:"Escudo Raniza FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:61,nombre:"Escudo Real Titán FC",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:62,nombre:"Escudo Atlético Parceras",tipo:"presisqlame",imagen:"https://i.ibb.co/MDN445S2/14-Amablitz.png"},
        { id:25,nombre:"Ainara Navas",tipo:"supercampeonas",imagen:"https://i.ibb.co/ZRzW9Lx8/25-SUPERCAMPEONAS-Ainara-Navas.png"},
        { id:26,nombre:"Bea Pérez",tipo:"supercampeonas",imagen:"https://i.ibb.co/PswsRSBC/26-SUPERCAMPEONAS-Beatriz-Perez.png"},
        { id:27,nombre:"Alba Ortiz",tipo:"supercampeonas",imagen:"https://i.ibb.co/qMhQgx0f/27-SUPERCAMPEONAS-Alba-Ortiz.png"},
        { id:28,nombre:"Aroney González",tipo:"supercampeonas",imagen:"https://i.ibb.co/0yYfkK9x/28-SUPERCAMPEONAS-Aroney-Gonzalez.png"},
        { id:29,nombre:"Paula Nieto",tipo:"supercampeonas",imagen:"https://i.ibb.co/F4WmsH3C/29-SUPERCAMPEONAS-Paula-Nieto.png"},
        { id:30,nombre:"Blanca Cros",tipo:"supercampeonas",imagen:"https://i.ibb.co/H9Bnsd5/30-SUPERCAMPEONAS-Blanca-Cros.png"},
        { id:31,nombre:"Mar Dalmau",tipo:"supercampeonas",imagen:"https://i.ibb.co/svv4Wrs0/31-SUPERCAMPEONAS-Mar-Dalmau.png"},
        { id:32,nombre:"Zoraida Pichardo",tipo:"supercampeonas",imagen:"https://i.ibb.co/Cs806S8S/32-SUPERCAMPEONAS-Zoraida-Pichardo.png"},
        { id:33,nombre:"Maria Pi",tipo:"supercampeonas",imagen:"https://i.ibb.co/7xWRkBtW/33-SUPERCAMPEONAS-Maria-Pi.png"},
        { id:34,nombre:"Patricia Mascaró",tipo:"supercampeonas",imagen:"https://i.ibb.co/C5g5jLZv/34-SUPERCAMPEONAS-Patricia-Mascar.png"},
        { id:35,nombre:"Berta Velasco",tipo:"supercampeonas",imagen:"https://i.ibb.co/vC7tvZD3/35-SUPERCAMPEONAS-Berta-Velasco.png"},
        { id:36,nombre:"Paula Blas",tipo:"supercampeonas",imagen:"https://i.ibb.co/cKjf90R8/36-SUPERCAMPEONAS-Paula-Blas.png"}
      ];

      // Cada sobre dará siempre estas 5 cartas (siempre lo mismo)
      const PACK_CONTENT = [1,2,3,4,5];

      // DOM refs
      const monedasPanel = document.getElementById("monedas-panel");
      const mainContent = document.getElementById("main-content");
      const notificacion = document.getElementById("notificacion");
      const modal = document.getElementById("modal");
      const modalImg = document.getElementById("modal-img");
      const modalClose = document.getElementById("modal-close");
      const modalInfo = document.getElementById("modal-info");
      const modalCards = document.getElementById("modal-cards");
      const modalCardsClose = document.getElementById("modal-cards-close");
      const modalCardsGrid = document.getElementById("modal-cards-grid");
      const modalCardsInfo = document.getElementById("modal-cards-info");

      // botones menu
      const btnSobres = document.getElementById("btn-sobres");
      const btnAlbum = document.getElementById("btn-album");
      const btnDaily = document.getElementById("btn-daily");
      const btnTwitter = document.getElementById("btn-twitter");
      const btnTwitch = document.getElementById("btn-twitch");

      // Estado en localStorage
      let monedas = parseInt(localStorage.getItem("monedas_queens")) || 2000;
      let album = JSON.parse(localStorage.getItem("album_queens")) || {}; // album[id] = cantidad
      let claimedDaily = JSON.parse(localStorage.getItem("bonus_daily_claimed")) || false;
      let claimedTwitter = JSON.parse(localStorage.getItem("bonus_twitter_claimed")) || false;
      let claimedTwitch = JSON.parse(localStorage.getItem("bonus_twitch_claimed")) || false;

      // ---- Utilidades ----
      function saveState() {
        localStorage.setItem("monedas_queens", monedas);
        localStorage.setItem("album_queens", JSON.stringify(album));
        localStorage.setItem("bonus_daily_claimed", JSON.stringify(claimedDaily));
        localStorage.setItem("bonus_twitter_claimed", JSON.stringify(claimedTwitter));
        localStorage.setItem("bonus_twitch_claimed", JSON.stringify(claimedTwitch));
      }

      function showNotificacion(msg, timeout = 2500) {
        if (!notificacion) return;
        notificacion.textContent = msg;
        notificacion.style.display = "block";
        setTimeout(() => { notificacion.style.display = "none"; }, timeout);
      }

      function updateMonedas() {
        monedasPanel.textContent = "Monedas: " + monedas;
        saveState();
      }

      // modal image
      modalClose && modalClose.addEventListener("click", () => modal.style.display = "none");
      modal && modal.addEventListener("click", e => { if (e.target === modal) modal.style.display = "none"; });

      // modal cards
      modalCardsClose && modalCardsClose.addEventListener("click", () => modalCards.style.display = "none");
      modalCards && modalCards.addEventListener("click", e => { if (e.target === modalCards) modalCards.style.display = "none"; });

      // ---- Views ----

      function renderMenu() {
        mainContent.innerHTML = `
          <div class="menu-principal">
            <h2 style="margin:0 0 .2rem 0;">Bienvenido al Álbum Virtual</h2>
            <p style="margin:0 0 .6rem 0; color:#444">Usa el menú superior o los botones de abajo para navegar.</p>
            <div class="actions">
              <button id="menu-open-packs" class="login-btn">Abrir Sobre (ir a página de sobres)</button>
              <button id="menu-view-album" class="login-btn">Ver Mi Álbum</button>
              <button id="menu-daily" class="login-btn">Bonus Diario</button>
              <button id="menu-twitter" class="login-btn">Bonus por seguir en X</button>
              <button id="menu-twitch" class="login-btn">Bonus por seguir en Twitch</button>
            </div>
            <p style="margin-top:0.8rem; color:var(--accent); font-weight:700;">Consejo: en "Abrir Sobre" verás 5 sobres. Cada sobre siempre contiene las mismas 5 cartas.</p>
          </div>
        `;
        document.getElementById("menu-open-packs")?.addEventListener("click", () => renderPacksPage());
        document.getElementById("menu-view-album")?.addEventListener("click", () => renderAlbumPage());
        document.getElementById("menu-daily")?.addEventListener("click", () => handleDailyBonus());
        document.getElementById("menu-twitter")?.addEventListener("click", () => handleTwitterBonus());
        document.getElementById("menu-twitch")?.addEventListener("click", () => handleTwitchBonus());
      }

      function renderPacksPage() {
        mainContent.innerHTML = `
          <h2 style="margin:0 0 .4rem 0;">Abrir Sobres</h2>
          <p style="margin:0 0 .6rem 0;">Hay 5 sobres disponibles. Cada sobre contiene siempre las mismas 5 cartas.</p>
          <div style="display:flex; gap:12px; margin-top:8px; justify-content:flex-end;">
            <button id="open-all" class="login-btn">Abrir todos los sobres</button>
            <button id="back-menu" class="login-btn" style="background:transparent; color:var(--accent); border:2px solid var(--accent);">Volver al menú</button>
          </div>
          <div class="packs-grid" id="packs-grid" style="margin-top:12px;"></div>
        `;
        const packsGrid = document.getElementById("packs-grid");
        for (let i = 1; i <= 5; i++) {
          const div = document.createElement("div");
          div.className = "pack";
          div.dataset.index = i;
          div.innerHTML = `<div style="text-align:center;">
                             <div style="font-size:1.05rem">Sobre ${i}</div>
                             <div style="font-size:0.85rem; margin-top:6px; color:#fff8">Contenido idéntico</div>
                           </div>`;
          div.addEventListener("click", () => openSinglePack(div));
          packsGrid.appendChild(div);
        }
        document.getElementById("open-all")?.addEventListener("click", () => openAllPacks());
        document.getElementById("back-menu")?.addEventListener("click", () => renderMenu());
      }

      function openSinglePack(packDiv) {
        if (!packDiv || packDiv.classList.contains("opened")) {
          showNotificacion("Este sobre ya está abierto.");
          return;
        }
        packDiv.classList.add("opened");
        PACK_CONTENT.forEach(id => { album[id] = (album[id] || 0) + 1; });
        saveState();
        showPackCardsModal("Has abierto el sobre y recibiste:");
      }

      function openAllPacks() {
        const packDivs = document.querySelectorAll(".packs-grid .pack");
        let countOpened = 0;
        packDivs.forEach(div => {
          if (!div.classList.contains("opened")) {
            div.classList.add("opened");
            PACK_CONTENT.forEach(id => { album[id] = (album[id] || 0) + 1; });
            countOpened++;
          }
        });
        if (countOpened === 0) {
          showNotificacion("Ya abriste todos los sobres.");
          return;
        }
        saveState();
        showPackCardsModal(`Has abierto ${countOpened} sobres. Cada sobre trae las mismas cartas:`);
      }

      function showPackCardsModal(titleText) {
        modalCardsGrid.innerHTML = "";
        modalCardsInfo.textContent = titleText;
        PACK_CONTENT.forEach(id => {
          const card = CARDS.find(c => c.id === id);
          const div = document.createElement("div");
          div.className = "cromo";
          div.innerHTML = `<img src="${card ? card.imagen : REVERSO}" alt="${card ? card.nombre : 'Cromo'}">`;
          modalCardsGrid.appendChild(div);
        });
        modalCards.style.display = "flex";
      }

      function renderAlbumPage() {
        mainContent.innerHTML = `
          <h2 style="margin:0 0 .4rem 0;">Mi Álbum</h2>
          <p style="margin:0 0 .6rem 0;">Tu colección personal de cromos. Haz clic en un cromo para verlo en grande.</p>
          <p class="progreso-album" id="progreso"></p>
          <div class="album-grid" id="album-grid"></div>
          <p style="margin-top:12px; color:var(--accent); font-weight:700;">Puedes vender duplicadas (cada duplicada = 100 monedas)</p>
        `;
        const albumGrid = document.getElementById("album-grid");
        const total = CARDS.length;
        const obtained = CARDS.filter(c => album[c.id]).length;
        document.getElementById("progreso").textContent = `Cartas obtenidas: ${obtained} / ${total}`;

        CARDS.sort((a,b) => a.id - b.id).forEach(card => {
          const div = document.createElement("div");
          div.className = "cromo";
          const img = document.createElement("img");
          img.src = album[card.id] ? card.imagen : REVERSO;
          img.alt = card.nombre;
          img.addEventListener("click", () => {
            if (album[card.id]) {
              modal.style.display = "flex";
              modalImg.src = card.imagen;
              modalInfo.textContent = `Nombre: ${card.nombre} · Copias: ${album[card.id]}`;
            } else {
              showNotificacion("Aún no tienes este cromo.");
            }
          });
          div.appendChild(img);
          if (album[card.id] && album[card.id] > 1) {
            const dup = document.createElement("span"); dup.className = "duplicadas"; dup.textContent = album[card.id];
            div.appendChild(dup);
            const btn = document.createElement("button"); btn.className = "btn-vender"; btn.textContent = "Vender";
            btn.addEventListener("click", (e) => {
              e.stopPropagation();
              sellDuplicates(card.id);
            });
            div.appendChild(btn);
          }
          albumGrid.appendChild(div);
        });
      }

      function sellDuplicates(cardId) {
        const qty = album[cardId] || 0;
        if (qty <= 1) {
          showNotificacion("No tienes duplicadas para vender.");
          return;
        }
        const duplicates = qty - 1;
        const gained = duplicates * 100;
        monedas += gained;
        album[cardId] = 1;
        saveState();
        updateMonedas();
        showNotificacion(`Vendiste ${duplicates} duplicadas y ganaste ${gained} monedas`);
        renderAlbumPage();
      }

      // Bonuses
      function handleDailyBonus() {
        const last = parseInt(localStorage.getItem("bonus_daily_last") || "0");
        const now = Date.now();
        const oneDay = 24 * 60 * 60 * 1000;
        if (!last || now - last > oneDay) {
          monedas += 2000;
          localStorage.setItem("bonus_daily_last", String(now));
          claimedDaily = true;
          saveState();
          updateMonedas();
          showNotificacion("Bonus diario reclamado: +2000 monedas 🎉");
        } else {
          showNotificacion("Ya reclamaste el bonus diario en las últimas 24h.");
        }
      }

      function handleTwitterBonus() {
        const url = "https://x.com/izandhh";
        window.open(url, "_blank", "noopener");
        if (claimedTwitter) {
          showNotificacion("Bonus por X ya reclamado.");
          return;
        }
        claimedTwitter = true;
        monedas += 1500;
        saveState();
        updateMonedas();
        showNotificacion("Bonus por seguir en X reclamado: +1500 monedas");
      }

      function handleTwitchBonus() {
        const url = "https://twitch.tv/izandhh";
        window.open(url, "_blank", "noopener");
        if (claimedTwitch) {
          showNotificacion("Bonus por Twitch ya reclamado.");
          return;
        }
        claimedTwitch = true;
        monedas += 1500;
        saveState();
        updateMonedas();
        showNotificacion("Bonus por seguir en Twitch reclamado: +1500 monedas");
      }

      // Header buttons
      btnSobres && btnSobres.addEventListener("click", () => renderPacksPage());
      btnAlbum && btnAlbum.addEventListener("click", () => renderAlbumPage());
      btnDaily && btnDaily.addEventListener("click", () => handleDailyBonus());
      btnTwitter && btnTwitter.addEventListener("click", () => handleTwitterBonus());
      btnTwitch && btnTwitch.addEventListener("click", () => handleTwitchBonus());

      // Init view and state
      updateMonedas();
      renderMenu();

      // Expose functions for debugging if needed
      window.renderMenu = renderMenu;
      window.renderPacksPage = renderPacksPage;
      window.renderAlbumPage = renderAlbumPage;

      console.log("App sin login inicializada con todas las cartas.");
    });
  </script>
</body>
</html>
